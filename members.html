<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة الأعضاء</title>
    <!-- ربط بمكتبة AdminLTE الخاصة بالشريط الجانبي و Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.1.0/dist/css/adminlte.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .content {
            margin-left: 250px; /* الشريط الجانبي ثابت على اليسار */
            padding: 20px;
        }

        /* تخصيص الأيقونة المتحركة قبل تحميل الأعضاء */
        #loading {
            display: none;
            text-align: center;
            font-size: 24px;
            color: #28a745;
        }

        table {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        th, td {
            text-align: center;
        }

        .btn-warning, .btn-danger {
            margin: 0 5px;
        }
    </style>
</head>
<body class="hold-transition sidebar-mini">

<!-- الشريط الجانبي باستخدام AdminLTE -->
<aside class="main-sidebar sidebar-dark-primary elevation-4">
    <a href="index.html" class="brand-link">
        <span class="brand-text font-weight-light">إدارة النظام</span>
    </a>
    <div class="sidebar">
        <nav class="mt-2">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">
                        <i class="nav-icon fas fa-tachometer-alt"></i>
                        <p>الرئيسية</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="members.html" class="nav-link active">
                        <i class="nav-icon fas fa-users"></i>
                        <p>إدارة الأعضاء</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="trainers.html" class="nav-link">
                        <i class="nav-icon fas fa-chalkboard-teacher"></i>
                        <p>إدارة المدربين</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="subscriptions.html" class="nav-link">
                        <i class="nav-icon fas fa-credit-card"></i>
                        <p>إدارة الاشتراكات</p>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="inventory.html" class="nav-link">
                        <i class="nav-icon fas fa-cogs"></i>
                        <p>إدارة المخزون</p>
                    </a>
                </li>
                <!-- إضافة أقسام أخرى هنا -->
            </ul>
        </nav>
    </div>
</aside>

<!-- المحتوى -->
<div class="content-wrapper">
    <section class="content">
        <div class="container-fluid">
            <h2>إدارة الأعضاء</h2>

            <!-- أيقونة التحميل -->
            <div id="loading">جاري تحميل الأعضاء...</div>

            <!-- نموذج إضافة عضو -->
            <form id="addMemberForm">
                <div class="mb-3">
                    <label for="memberName" class="form-label">اسم العضو</label>
                    <input type="text" class="form-control" id="memberName" required>
                </div>
                <div class="mb-3">
                    <label for="memberEmail" class="form-label">البريد الإلكتروني</label>
                    <input type="email" class="form-control" id="memberEmail" required>
                </div>
                <div class="mb-3">
                    <label for="memberPhone" class="form-label">رقم الهاتف</label>
                    <input type="text" class="form-control" id="memberPhone" required>
                </div>
                <div class="mb-3">
                    <label for="memberJoinDate" class="form-label">تاريخ الانضمام</label>
                    <input type="date" class="form-control" id="memberJoinDate" required>
                </div>
                <button type="submit" class="btn btn-success">إضافة العضو</button>
            </form>

            <h3 class="mt-5">قائمة الأعضاء</h3>
            <table class="table table-bordered mt-3">
                <thead>
                    <tr>
                        <th>اسم العضو</th>
                        <th>البريد الإلكتروني</th>
                        <th>رقم الهاتف</th>
                        <th>تاريخ الانضمام</th>
                        <th>التحكم</th>
                    </tr>
                </thead>
                <tbody id="membersList">
                    <!-- سيتم تحميل الأعضاء هنا -->
                </tbody>
            </table>
        </div>
    </section>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/admin-lte@3.1.0/dist/js/adminlte.min.js"></script>

<script>
    // وظيفة لتحميل الأعضاء
    const loadMembers = () => {
        setTimeout(() => {
            const members = JSON.parse(localStorage.getItem('members')) || [];
            const tableBody = document.getElementById('membersList');
            tableBody.innerHTML = '';

            members.forEach((member, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${member.name}</td>
                    <td>${member.email}</td>
                    <td>${member.phone}</td>
                    <td>${member.joinDate}</td>
                    <td>
                        <button class="btn btn-warning btn-sm" onclick="editMember(${index})">تعديل</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteMember(${index})">حذف</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });

            document.getElementById('loading').style.display = 'none'; // إخفاء الأيقونة بعد تحميل الأعضاء
        }, 3000); // تأخير 3 ثوانٍ
    };

    // تعديل عضو
    const editMember = (index) => {
        const members = JSON.parse(localStorage.getItem('members')) || [];
        const member = members[index];
        document.getElementById('memberName').value = member.name;
        document.getElementById('memberEmail').value = member.email;
        document.getElementById('memberPhone').value = member.phone;
        document.getElementById('memberJoinDate').value = member.joinDate;

        // تعديل الزر ليحفظ التعديل
        const submitButton = document.querySelector('button[type="submit"]');
        submitButton.textContent = 'تحديث العضو';

        submitButton.onclick = () => {
            member.name = document.getElementById('memberName').value;
            member.email = document.getElementById('memberEmail').value;
            member.phone = document.getElementById('memberPhone').value;
            member.joinDate = document.getElementById('memberJoinDate').value;

            localStorage.setItem('members', JSON.stringify(members));
            loadMembers();
            submitButton.textContent = 'إضافة العضو';
        };
    };

    // حذف عضو
    const deleteMember = (index) => {
        const members = JSON.parse(localStorage.getItem('members')) || [];
        members.splice(index, 1);
        localStorage.setItem('members', JSON.stringify(members));
        loadMembers();
    };

    // إضافة عضو جديد
    const addMemberForm = document.getElementById('addMemberForm');
    addMemberForm.addEventListener('submit', (event) => {
        event.preventDefault();

        // إظهار الأيقونة المتحركة
        document.getElementById('loading').style.display = 'block';

        // استخراج البيانات من النموذج
        const memberName = document.getElementById('memberName').value;
        const memberEmail = document.getElementById('memberEmail').value;
        const memberPhone = document.getElementById('memberPhone').value;
        const memberJoinDate = document.getElementById('memberJoinDate').value;

        // إضافة البيانات إلى localStorage
        const members = JSON.parse(localStorage.getItem('members')) || [];
        members.push({ name: memberName, email: memberEmail, phone: memberPhone, joinDate: memberJoinDate });
        localStorage.setItem('members', JSON.stringify(members));

        // إعادة تحميل الأعضاء بعد الإضافة
        loadMembers();
    });

    // تحميل الأعضاء عند فتح الصفحة
    window.onload = loadMembers;
</script>

</body>
</html>
